{"version":3,"sources":["api/callback/callback.controller.js"],"names":["config","require","request","path","headers","api","from","component","defaults","debug","exports","req","res","options","url","uri","qs","query","body","post","error","response","console","log","send","pubno","join","params","appid"],"mappings":"AAAA;;;;;;;;AAEA,IAAIA,SAASC,QAAQ,0BAAR,CAAb;AACA,IAAIC,UAAUD,QAAQ,SAAR,CAAd;AACA,IAAIE,OAAOF,QAAQ,MAAR,CAAX;AACA,IAAIG,UAAU;AACR,gBAAgBJ,OAAOK,GAAP,CAAWC,IADnB;AAER,iBAAgBN,OAAOK,GAAP,CAAWE;AAFnB,CAAd;AAIAL,UAAUA,QAAQM,QAAR,CAAiB,EAACJ,SAASA,OAAV,EAAjB,CAAV;AACAF,QAAQO,KAAR,GAAgB,KAAhB;;AAEAC,QAAQH,SAAR,GAAoB,UAASI,GAAT,EAAcC,GAAd,EAAkB;AACpC,MAAIC,UAAU;AACZC,SAAMd,OAAOK,GAAP,CAAWU,GAAX,GAAiB,4BADX;AAEZC,QAAGL,IAAIM,KAFK;AAGZC,UAAMP,IAAIO;AAHE,GAAd;AAKA,SAAOd,QAAQ,SAAR,CAAP;AACAF,UAAQiB,IAAR,CAAaN,OAAb,EAAqB,UAAUO,KAAV,EAAiBC,QAAjB,EAA2BH,IAA3B,EAAiC;AACpD,QAAGE,KAAH,EAAUE,QAAQF,KAAR,CAAc,gBAAd,EAA+BA,KAA/B;AACVE,YAAQC,GAAR,CAAY,eAAZ,EAA4BL,IAA5B;AACAN,QAAIY,IAAJ,CAASN,IAAT;AACD,GAJD;AAKD,CAZD;AAaAR,QAAQe,KAAR,GAAgB,UAASd,GAAT,EAAcC,GAAd,EAAkB;AAChC,MAAIE,MAAMd,OAAOK,GAAP,CAAWU,GAAX,GAAiB,YAAjB,GAAgCZ,KAAKuB,IAAL,CAAUf,IAAIgB,MAAJ,CAAWC,KAArB,EAA4B,QAA5B,CAA1C;AACA,MAAIf,UAAU;AACZC,SAAKA,GADO;AAEZE,QAAIL,IAAIM,KAFI;AAGZC,UAAMP,IAAIO;AAHE,GAAd;AAKAI,UAAQC,GAAR,CAAY,6CAA6C,yBAAeZ,IAAIgB,MAAnB,CAAzD;AACAvB,UAAQ,SAAR,IAAqBO,IAAIgB,MAAJ,CAAWC,KAAhC;AACD1B,YAAUA,QAAQM,QAAR,CAAiB,EAACJ,SAASA,OAAV,EAAjB,CAAV;AACCF,UAAQiB,IAAR,CAAaN,OAAb,EAAqB,UAAUO,KAAV,EAAiBC,QAAjB,EAA2BH,IAA3B,EAAiC;AACpD,QAAGE,KAAH,EAAUE,QAAQF,KAAR,CAAc,kBAAd,EAAiCA,KAAjC;AACVE,YAAQC,GAAR,CAAY,iBAAZ,EAA8BL,IAA9B;AACAN,QAAIY,IAAJ,CAASN,IAAT;AACD,GAJD;AAKD,CAfD","file":"api/callback/callback.controller.js","sourcesContent":["'use strict';\n\nvar config = require('../../config/environment');\nvar request = require('request');\nvar path = require('path');\nvar headers = {\n      'X-API-From'　　: config.api.from,\n      'X-Component'　: config.api.component\n    }\nrequest = request.defaults({headers: headers});\nrequest.debug = false;\n\nexports.component = function(req, res){\n  var options = {\n    url : config.api.uri + \"/wechat/component/callback\",\n    qs:req.query,\n    body: req.body\n  };\n  delete headers['X-APPID'];\n  request.post(options,function (error, response, body) {\n    if(error) console.error('com_call_error',error);\n    console.log('com_call_body',body);\n    res.send(body);\n  });\n}\nexports.pubno = function(req, res){\n  let url = config.api.uri + '/callback/' + path.join(req.params.appid, \"/pubno\"); \n  var options = {\n    url: url,\n    qs: req.query,\n    body: req.body,\n  };\n  console.log(\"callback.controller.js pubno req.params \" + JSON.stringify(req.params));\n  headers['X-APPID'] = req.params.appid;\n\trequest = request.defaults({headers: headers});\n  request.post(options,function (error, response, body) {\n    if(error) console.error('pubno_call_error',error);\n    console.log('pubno_call_body',body);\n    res.send(body);\n  });\n}\n"],"sourceRoot":"/source/"}